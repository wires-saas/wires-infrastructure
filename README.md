# wires-infrastructure

Repository based on Ansible to deploy and maintain infrastructure

## Requirements

- Ansible installed
- Authorized public key on the target servers
- `debian` user on remote servers (ansible.cfg)
- Ansible Vault secret (vault/password.txt)
- Group_vars files (secrets for Docker, Mongo, Watchtower, etc.)

## Description

Project allows for a small infra deployment and maintenance, with prod and dev environments.
Heavily relying on Docker containers, with WatchTower to auto deploy new images pushed through Github Actions.
Currently it's a low cost/low maintenance infra with limited scalability, with secrets encryption, private network, certificates, etc.

Playbooks are available for the following tasks:

- Install dependencies
- Install docker
- Setup firewall
- Obtain SSL certificates (with OVH API for DNS check)
- Install database (mongo cluster)
- Setup castle instance (proxy for instances in VPN)
- Setup infrastructure (prod and dev environments)
- Setup monitoring (uptime kuma, status.wires.fr)

### Schema with opened ports

![Schema Infra](https://dev.wires.fr/schemas/topology--ports.png "Schema Infra")
This schema is auto-generated by **[docker-compose-viz](https://github.com/pmsipilot/docker-compose-viz)** tool,
transforming the `docker-compose.yml` file into a visual representation of the infrastructure.

### Schema with networks

![Schema Infra Networks](https://dev.wires.fr/schemas/topology--networks.png "Schema Infra Networks")

### Diagram of complete infra

![Diagram Complete](https://dev.wires.fr/schemas/network-diagram.png "Diagram Complete")

## Next steps

- Using Terraform to provision machines in VPC
- Use Kubernetes for enhanced scaling and deployments
